<!DOCTYPE html>
<html lang="en" class="h-100">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="Tiago Barroso" />
    <title>Demo Â· kde_diffusion</title>

    <!-- Bootstrap core CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <!-- Math typesetting -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css"
      integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib"
      crossorigin="anonymous"
    />
    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js"
      integrity="sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh"
      crossorigin="anonymous"
    ></script>
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js"
      integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh"
      crossorigin="anonymous"
      onload="renderMathInElement(document.body);"
    ></script>

    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>
  </head>
  <body class="d-flex flex-column h-100">
    <header>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Demo for <code>kde_diffusion</code></a>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav me-auto mb-2 mb-md-0">
              <li class="nav-item">
                <a
                  class="nav-link active"
                  aria-current="page"
                  href="https://github.com/tmbb/kde_diffusion"
                  >GitHub repository
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Begin page content -->
    <main>
      <div class="container">
        <div class="col-md-9">
          <h1 class="mt-3">
            Demo page for the <code>kde_diffusion</code> package
          </h1>
  
          <h2 class="mt-3">Introduction</h2>
  
          <h2 class="mt-3">Examples</h2>
          <p>
            The following examples were taken from the paper of
            <em>Botev et al.</em> from 2010 <strong>(TODO: add link)</strong>. In
            all the examples, the rust implementation is compared to the Python
            implementation. The Python implementation resulted from the
            translation of the original Matlab code by <em>Botev et al.</em> into
            Python. The Python repository contains a single test case where the
            Python and Matlab inputs are compared.
          </p>
  
          <h3 class="mt-4">1. Claw</h3>
          {{ botev_01_claw_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{1}{2}N(0,1) + \sum_{k=0}^{4} \frac{1}{10} N\left(\frac{k}{2}
            - 1, \left(\frac{1}{10}\right)^2\right) $$
          </p>
  
          <h3 class="mt-4">2. Strongly skewed</h3>
          {{ botev_02_strongly_skewed_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \sum_{k=0}^{7} \frac{1}{8} N\left(3\left(\left(\frac{2}{3}\right)^k
            - 1\right), \left(\frac{2}{3}\right)^{2k}\right) $$
          </p>

          <h3 class="mt-4">3. Kurtotic unimodal</h3>
          {{ botev_03_kurtotic_unimodal_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{2}{3} N(0, 1) + \frac{1}{3} N\left(0,
            \left(\frac{1}{10}\right)^2\right) $$
          </p>
  
          <h3 class="mt-4" id="botev_04_double_claw">4. Double claw</h3>
          {{ botev_04_double_claw_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{49}{100} N\left(-1, \left(\frac{2}{3}\right)^2\right) +
            \frac{49}{100} N\left(1, \left(\frac{2}{3}\right)^2\right) +
            \frac{1}{350} \sum_{k=0}^6 N\left(\frac{k-3}{2},
            \left(\frac{1}{100}\right)^2\right) $$
          </p>
  
          <h3 class="mt-4">5. Discrete comb</h3>
          {{ botev_05_discrete_comb_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{2}{7} \sum_{k=0}^{2} N\left(\frac{12k-15}{7},
            \left(\frac{2}{7}\right)^2\right) + \frac{1}{21} \sum_{k=8}^{10}
            N\left(\frac{2k}{7}, \left(\frac{1}{21}\right)^2\right) $$
          </p>
  
          <h3 class="mt-4">6. Asymmetric double claw</h3>
          {{ botev_06_asymmetric_double_claw_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{46}{100} \sum_{k=0}^{1} N\left(2k-1,
            \left(\frac{2}{3}\right)^2\right) + \sum_{k=1}^{3} \frac{1}{300}
            N\left(-\frac{k}{2}, \left(\frac{1}{100}\right)^2\right) $$
          </p>
  
          <h3 class="mt-4">7. Outlier</h3>
          {{ botev_07_outlier_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{1}{10} N(0, 1) + \frac{9}{10} N\left(0,
            \left(\frac{1}{10}\right)^2\right) $$
          </p>
  
          <h3 class="mt-4">8. Separated bimodal</h3>
          {{ botev_08_separated_bimodal_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{1}{2}N\left(-12, \frac{1}{4}\right) + \frac{1}{2}N\left(12,
            \frac{1}{4}\right) $$
          </p>
  
          <h3 class="mt-4">9. Skewed bimodal</h3>
          {{ botev_09_skewed_bimodal_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{3}{4}N(0,1) + \frac{1}{4}N\left(\frac{3}{2},
            \left(\frac{1}{3}\right)^2\right) $$
          </p>
  
          <h3 class="mt-4">10. Bimodal</h3>
          {{ botev_10_bimodal_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            $$ \frac{1}{2} N\left(0, \left(\frac{1}{10}\right)^2\right) +
            \frac{1}{2} N(5, 1) $$
          </p>
          
          <h3 class="mt-4">14. Five modes</h3>
          {{ botev_14_five_modes_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            FORMULA
          </p>
  
          <h3 class="mt-4">16. Smooth comb</h3>
          {{ botev_16_smooth_comb_plot | safe }}
          <p class="text-center">Target density \(f(x)\):</p>
          <p>
            FORMULA
          </p>
  
          <h2 class="mt-3">Benchmarks</h2>
  
          <p>
            You can look up the benchmarks for performance as a function
            of the number of samples given to the density estimator
            <a href="benchmarks/double-claw/report/index.html">here</a>.
            The density used for this benchmark is the
            <a href="#botev_04_double_claw">Double claw distribution</a>
            above.
          </p>
  
          <h3>Profiling</h3>
          
          <p>
            Profiling shows that for a smaller number of datapoints,
            the calculation of the optimal bandwidth (using the Brent root finder)
            dominates the execution time.
            As the number of datapoints grows, the binning of the datapoints
            dominates and the root finding algorithm becomes less important.
          </p>
  
          <p>
            You can visualize the impact of the different parts of the algorithm
            in the following flamegraphs.
          </p>
  
          <ul class="list-group">
            <li class="list-group-item">
              <a href="benchmarks/double-claw/Throughput/0020k/profile/flamegraph.svg">
                Flamegraph for 20,000 datapoints
              </a>
            </li>
            <li class="list-group-item">
              <a href="item">
                <a href="double-claw/Throughput/0040k/profile/flamegraph.svg">
                Flamegraph for 40,000 datapoints
              </a>
            </li>
            <li class="list-group-item">
              <a href="benchmarks/double-claw/Throughput/0060k/profile/flamegraph.svg">
                Flamegraph for 60,000 datapoints
              </a>
            </li>
            <li class="list-group-item">
              <a href="benchmarks/double-claw/Throughput/0100k/profile/flamegraph.svg">
                Flamegraph for 100,000 datapoints
              </a>
            </li>
          </ul>
        </div>
      </div>
    </main>

    <footer class="footer mt-auto py-3 bg-light">
      <div class="container">
        <span class="text-muted">Demo densities for <code>kde_diffusion</code></span>
      </div>
    </footer>
  </body>
</html>
